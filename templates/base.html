{% load static %}
{% url 'home' as home_url %}
{% url 'clubs' as clubs_url %}
{% url 'contact' as contact_url %}
{% url 'account_login' as login_url %}
{% url 'account_signup' as signup_url %}
{% url 'account_logout' as logout_url %}
{% url 'account_change_password' as change_password_url %}
{% url 'account_settings' as account_settings_url %}
{% url 'club_admin_dashboard' as club_admin_dashboard_url %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="City and District - Yorkshire's leading table tennis league. Explore fixtures, results, rankings, player stats, and club info all in one place. Join the action today!"
    />
    <title>City and District | Table Tennis League</title>
    <meta
      name="keywords"
      content="table tennis, York table tennis league, table tennis clubs York, table tennis fixtures, league results, league tables, player rankings, join table tennis league, local table tennis competitions"
    />

    <!-- Favicons generated by favicon.io using custom image -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="{% static 'images/favicon/apple-touch-icon.png' %}"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="{% static 'images/favicon/favicon-32x32.png' %}"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="{% static 'images/favicon/favicon-16x16.png' %}"
    />
    <link
      rel="manifest"
      href="{% static 'images/favicon/site.webmanifest' %}"
    />

    <!-- Bootstrap 5 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/global.css' %}" />
  </head>

  <body>
    <!-- Header -->
    <header>
      <!-- Navbar -->
      <nav
        class="navbar fixed-top bg-dark navbar-expand-sm"
        data-bs-theme="dark"
      >
        <div class="container-lg">
          <!-- Navbar logo -->
          <a class="navbar-brand d-flex align-items-center gap-2" href="{{ home_url }}">
            <img
              src="{% static 'images/nav-logo.png' %}"
              alt="City and District Table Tennis League Logo"
              id="nav-logo"
            />
            <div>CITY AND DISTRICT</div>
          </a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto mb-md-0">
              <!-- Home -->
              <li class="nav-item">
                <a
                  class="nav-link{% if request.path == home_url %} active{% endif %}"
                  {% if request.path == home_url %}aria-current="page"{% endif %}
                  href="{{ home_url }}"
                >
                  Home
                </a>
              </li>
              <!-- Clubs -->
              <li class="nav-item">
                <a
                  class="nav-link{% if request.path == clubs_url %} active{% endif %}"
                  {% if request.path == clubs_url %}aria-current="page"{% endif %}
                  href="{{ clubs_url }}"
                >
                  Clubs
                </a>
              </li>
              <!-- Contact -->
              <li class="nav-item">
                <a
                  class="nav-link{% if request.path == contact_url %} active{% endif %}"
                  {% if request.path == contact_url %}aria-current="page"{% endif %}
                  href="{{ contact_url }}"
                >
                  Contact
                </a>
              </li>
              <!-- User Dropdown -->
              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle{% if user.is_authenticated %} nav-user-highlight{% endif %}"
                  href="#"
                  role="button"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  <i class="fa-solid fa-user fs-4"></i>
                </a>
                <ul class="dropdown-menu dropdown-menu-end mb-2">
                  {% if user.is_authenticated %}
                    {% if request.user.club_admin %}
                    <li><a class="dropdown-item" href="{{ club_admin_dashboard_url }}">Club Admin</a></li>
                    <li><hr class="dropdown-divider" /></li>
                    {% endif %}
                  <li><a class="dropdown-item" href="{{ logout_url }}">Logout</a></li>
                  <li><hr class="dropdown-divider" /></li>
                  <li><a class="dropdown-item" href="{{ change_password_url }}?next={{ request.path }}">Change Password</a></li>
                  <li><a class="dropdown-item" href="{{ account_settings_url }}">Account Settings</a></li>
                  {% else %}
                  <li><a class="dropdown-item" href="{{ login_url }}">Login</a></li>
                  <li><hr class="dropdown-divider" /></li>
                  <li><a class="dropdown-item" href="{{ signup_url }}">Signup</a></li>
                  {% endif %}
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Main -->
    <main>
      <!-- Show logged in user-->
      {% if user.is_authenticated %}
      <div class="user-banner w-100">
        <div class="container-lg d-flex justify-content-end">
            <div class="user-logged-in fst-italic">
              Logged in as {{ user.username }}
            </div>
        </div>
      </div>
      {% endif %}
      
      <!-- Messages -->
      {% if messages %}
      <div class="container-lg bring-to-front">
        <div class="row">
          <div class="col-12">
            <div class="alert-container">
              {% for message in messages %}
                  <div class="alert alert-{{ message.tags }} alert-dismissible fade show">
                      {{ message }}
                      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                  </div>
              {% endfor %}
          </div>
          </div>
        </div>
      </div>
      {% endif %}
      
      <!-- Content -->
      {% block content %} {% endblock %}
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-white">
      <section id="contact">
        <div class="container-lg">
          <div class="row text-center align-items-center m-1">
            <div class="col-12 col-sm-4 my-1">
              <a href="{{ contact_url }}" aria-label="Visit the contact page">
                <h2 class="fs-6 m-0">Contact Us</h2>
              </a>
            </div>
            <div class="col-12 col-sm-4 fs-5 my-1">
              <div class="social-media">
                <a href="https://www.instagram.com" target="_blank"
                    aria-label="Visit our Instagram page (opens in a new tab)" rel="noopener noreferrer"><i
                        class="fa-brands fa-instagram" aria-hidden="true"></i></a>
                <a href="https://www.facebook.com" target="_blank"
                    aria-label="Visit our Facebook page (opens in a new tab)" rel="noopener noreferrer"><i
                        class="fa-brands fa-square-facebook" aria-hidden="true"></i></a>
                <a href="https://www.x.com" target="_blank" aria-label="Visit our X feed (opens in a new tab)"
                    rel="noopener noreferrer"><i class="fa-brands fa-x-twitter" aria-hidden="true"></i></a>
              </div>
            </div>
            <div class="col-12 col-sm-4 my-1">
              Â© 2025 Peter Lowry
            </div>
          </div>
        </div>
      </section>
    </footer>

    <!-- Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <!-- Font Awesome kit -->
    <script
      src="https://kit.fontawesome.com/fb3aff35ac.js"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
